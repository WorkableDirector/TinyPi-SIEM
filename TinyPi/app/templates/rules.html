<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Rules Manager â€¢ TinyPi SIEM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/theme.css">
</head>
<body>
<main class="container">
  <nav>
    <ul><li><strong>TinyPi SIEM</strong></li></ul>
    <ul>
      <li><a href="/">Dashboard</a></li>
      <li><a href="/logs">Logs</a></li>
      <li><a href="/alerts">Alerts</a></li>
      <li><a href="/rules" aria-current="page">Rules</a></li>
    </ul>
  </nav>

  <section class="hero">
    <p class="section-title">Detection logic</p>
    <h2 class="section-heading">Tune the alerts independently from logs</h2>
    <p class="tagline">Rules inspect incoming syslog traffic and emit alerts without mutating the stored raw events. Adjust the regex patterns and severities to refine what triggers notifications.</p>
  </section>

  <article class="card" style="margin-bottom:16px;">
    <header style="display:flex; justify-content:space-between; align-items:center;">
      <div>
        <p class="section-title" style="margin:0;">Add custom rule</p>
        <h3 style="margin:4px 0 0 0;">New detection</h3>
      </div>
    </header>
    <form action="/rules/add" method="POST" class="filters" style="margin-top:12px; align-items:flex-end;">
      <div>
        <label for="name">Rule name</label>
        <input id="name" type="text" name="name" placeholder="Nmap scan" required>
      </div>
      <div>
        <label for="severity">Severity</label>
        <select id="severity" name="severity">
          <option value="low">Low</option>
          <option value="medium" selected>Medium</option>
          <option value="high">High</option>
          <option value="critical">Critical</option>
        </select>
      </div>
      <div>
        <label for="pattern">Regex pattern</label>
        <input id="pattern" type="text" name="pattern" placeholder="nmap|scan|brute" required>
      </div>
      <div class="controls">
        <button type="submit" class="primary">Save rule</button>
        <a href="/rules" role="button" class="secondary">Reset</a>
      </div>
    </form>
  </article>

  <article class="card table-card">
    <table>
      <thead><tr><th>Name</th><th>Severity</th><th>Regex Pattern</th><th>Action</th></tr></thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td><strong>{{ r.name }}</strong></td>
          <td><span class="badge sev-{{ r.severity }}">{{ r.severity }}</span></td>
          <td><code>{{ r.pattern }}</code></td>
          <td><a href="/rules/delete/{{ r.id }}" role="button" class="secondary" style="padding:6px 12px;">Delete</a></td>
        </tr>
        {% else %}
        <tr><td colspan="4" class="empty">No rules configured.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </article>
</main>
</body>
</html>
